{# SPDX-FileCopyrightText: Â© 2022 Siemens AG #}
{# SPDX-License-Identifier: GPL-2.0-only AND LGPL-2.1-only #}
{% extends "include/base.html.twig" %}

{% block content %}
<div class="container">
  <h2>{{ phrase is defined ? 'Edit' : 'Add' }} Text Phrase</h2>
  
  <form method="post" class="needs-validation" novalidate>
    <div class="form-group">
      <label for="license_id">License</label>
      <select class="form-control" id="license_id" name="license_id" required>
        <option value="">Select a license</option>
        {% for license in licenses %}
          <option value="{{ license.rf_pk }}" 
                  {{ phrase is defined and phrase.license_fk == license.rf_pk ? 'selected' : '' }}>
            {{ license.rf_shortname }}
          </option>
        {% endfor %}
      </select>
      <div class="invalid-feedback">
        Please select a license.
      </div>
    </div>

    <div class="form-group">
      <label for="text">Text Phrase</label>
      <textarea class="form-control" id="text" name="text" rows="3" required>{{ phrase is defined ? phrase.text : '' }}</textarea>
      <div class="invalid-feedback">
        Please enter a text phrase.
      </div>
    </div>

    <div class="form-group">
      <label for="acknowledgement">Acknowledgement</label>
      <textarea class="form-control" id="acknowledgement" name="acknowledgement" rows="2">{{ phrase is defined ? phrase.acknowledgement : '' }}</textarea>
    </div>

    <div class="form-group">
      <label for="comments">Comments</label>
      <textarea class="form-control" id="comments" name="comments" rows="2">{{ phrase is defined ? phrase.comments : '' }}</textarea>
    </div>

    {% if phrase is defined %}
    <div class="form-group">
      <div class="custom-control custom-switch">
        <input type="checkbox" class="custom-control-input" id="is_active" name="is_active" 
               {{ phrase.is_active ? 'checked' : '' }}>
        <label class="custom-control-label" for="is_active">Active</label>
      </div>
    </div>
    {% endif %}

    <div class="form-group">
      <button type="submit" class="btn btn-primary">Save</button>
      <a href="?mod=textphrase" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>

<script>
// Form validation
(function() {
  'use strict';
  window.addEventListener('load', function() {
    var forms = document.getElementsByClassName('needs-validation');
    Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();
</script>
{% endblock %} 